<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="21song">
  
  
  
  
  <link rel="next" href="/1/bi%E6%9E%B6%E6%9E%84%E6%A6%82%E5%BF%B5/" />
  <link rel="canonical" href="/1/pywin32%E6%8E%A7%E5%88%B6%E4%BD%A0%E7%9A%84%E6%89%93%E5%8D%B0%E6%9C%BA/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           pywin32控制你的打印机 | 宋军亮的技术博客
       
  </title>
  <meta name="title" content="pywin32控制你的打印机 | 宋军亮的技术博客">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "\/"
    },
    "articleSection" : "posts",
    "name" : "pywin32控制你的打印机",
    "headline" : "pywin32控制你的打印机",
    "description" : "pywin32控制你的打印机\n` def printer(name,phone,place): import win32ui import win32gui import win32print import win32con print_name =win32print.GetDefaultPrinter() # test 获取默认打印机 pHandle = win32print.OpenPrinter(win32print.GetDefaultPrinter()) printinfo = win32print.GetPrinter(pHandle,2) pDevModeObj = printinfo[\x26quot;pDevMode\x26quot;] pDevModeObj.Scale=10 # pDevModeObj.Orientation=win32con.DMORIENT_LANDSCAPE # 文本横向 print(pDevModeObj.Scale) DC=win32gui.CreateDC(\x27WINSPOOL\x27,print_name,pDevModeObj) hDC=win32ui.CreateDCFromHandle(DC) hDC.StartDoc(\x26quot;Test doc\x26quot;) hDC.StartPage() # hDC.SetMapMode(win32con.MM_TWIPS*50) hDC.TextOut(20,10,\x26quot;我是要打印的内容\x26quot;) #draws text within a box (assume about 1400 dots per inch for typical HP printer) ulc_x = 100 # give a left margin ulc_y = -100 # give a top margin lrc_x = 160 # width of text area-margin, close to right edge of page lrc_y = -110 # height of text area-margin, close to bottom of the page hDC.",
    "inLanguage" : "en-us",
    "author" : "Song",
    "creator" : "Song",
    "publisher": "Song",
    "accountablePerson" : "Song",
    "copyrightHolder" : "Song",
    "copyrightYear" : "0001",
    "datePublished": "0001-01-01 00:00:00 \x2b0000 UTC",
    "dateModified" : "0001-01-01 00:00:00 \x2b0000 UTC",
    "url" : "\/1\/pywin32%E6%8E%A7%E5%88%B6%E4%BD%A0%E7%9A%84%E6%89%93%E5%8D%B0%E6%9C%BA\/",
    "wordCount" : "215",
    "keywords" : [ "python", "宋军亮的技术博客"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="/">宋军亮的技术博客</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="/">宋军亮的技术博客</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">pywin32控制你的打印机</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="/" rel="author">Song</a> with ♥ 
                <span class="post-time">
                on <time datetime=0001-01-01 itemprop="datePublished">January 1, 0001</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="/categories/python/"> python </a>
                        
                </span>
        </div>
    </header>
    <div class="post-content">
        

        

        
        
     
          
          
          

          
          
          

          <p>pywin32控制你的打印机</p>

<pre><code>`
def printer(name,phone,place):
    import win32ui
    import win32gui
    import win32print
    import win32con

    print_name =win32print.GetDefaultPrinter()  # test 获取默认打印机
    pHandle = win32print.OpenPrinter(win32print.GetDefaultPrinter())
    printinfo = win32print.GetPrinter(pHandle,2)

    pDevModeObj = printinfo[&quot;pDevMode&quot;]
    pDevModeObj.Scale=10
    # pDevModeObj.Orientation=win32con.DMORIENT_LANDSCAPE # 文本横向
    print(pDevModeObj.Scale)


    DC=win32gui.CreateDC('WINSPOOL',print_name,pDevModeObj)
    hDC=win32ui.CreateDCFromHandle(DC)

    hDC.StartDoc(&quot;Test doc&quot;)

    hDC.StartPage()
    # hDC.SetMapMode(win32con.MM_TWIPS*50)
    hDC.TextOut(20,10,&quot;我是要打印的内容&quot;)
    #draws text within a box (assume about 1400 dots per inch for typical HP printer)
    ulc_x = 100    # give a left margin
    ulc_y = -100   # give a top margin
    lrc_x = 160   # width of text area-margin, close to right edge of page
    lrc_y = -110 # height of text area-margin, close to bottom of the page
    hDC.DrawText('', (ulc_x, ulc_y, lrc_x, lrc_y), win32con.DT_CENTER)

    hDC.EndPage()
    hDC.EndDoc()

    win32gui.DeleteDC(DC)`

</code></pre>

<p>当然还有一些其他的参数</p>

<pre><code>`
OpenPrinter　　打开指定的打印机，并获取打印机的句柄

GetPrinter　　取得与指定打印机有关的信息

SetPrinter　　对一台打印机的状态进行控制

ClosePrinter　　关闭一个打开的打印机对象

AddPrinterConnection　　连接指定的打印机

DeletePrinterConnection　　删除与指定打印机的连接

EnumPrinters　　枚举系统中安装的打印机

GetDefaultPrinter　　取得默认打印机名称 &lt;type 'str'&gt;

GetDefaultPrinterW　　取得默认打印机名称 &lt;type 'unicode'&gt;

SetDefaultPrinter　　对一台打印机名称 &lt;type 'str'&gt; 设置成默认打印机

SetDefaultPrinterW　　对一台打印机名称 &lt;type 'unicode'&gt; 设置成默认打印机

StartDocPrinter　　在后台打印的级别启动一个新文档

EndDocPrinter　　在后台打印程序的级别指定一个文档的结束

AbortPrinter　　删除与一台打印机关联在一起的缓冲文件

StartPagePrinter　　在打印作业中指定一个新页的开始

EndPagePrinter　　指定一个页在打印作业中的结尾

StartDoc　　开始一个打印作业

EndDoc　　结束一个成功的打印作业

AbortDoc　　取消一份文档的打印

StartPage　　打印一个新页前要先调用这个函数

EndPage　　用这个函数完成一个页面的打印，并准备设备场景，以便打印下一个页

WritePrinter　　将发送目录中的数据写入打印机

EnumJobs　　枚举打印队列中的作业

GetJob　　获取与指定作业有关的信息

SetJob　　对一个打印作业的状态进行控制

DocumentProperties　　打印机配置控制函数

EnumPrintProcessors　　枚举系统中可用的打印处理器

EnumPrintProcessorDatatypes　　枚举由一个打印处理器支持的数据类型

EnumPrinterDrivers　　枚举指定系统中已安装的打印机驱动程序

EnumForms　　枚举一台打印机可用的表单

AddForm　　为打印机的表单列表添加一个新表单

DeleteForm　　从打印机可用表单列表中删除一个表单

GetForm　　取得与指定表单有关的信息

SetForm 为指定的表单设置信息

AddJob　　用于获取一个有效的路径名，以便用它为作业创建一个后台打印文件。它也会为作业分配一个作业编号

ScheduleJob　　提交一个要打印的作业

DeviceCapabilities　　利用这个函数可获得与一个设备的能力有关的信息

GetDeviceCaps　　获取指定设备的参数设置

EnumMonitors　　枚举可用的打印监视器

EnumPorts　　枚举一个系统可用的端口

GetPrintProcessorDirectory　　判断指定系统中包含了打印机处理器驱动程序及文件的目录

GetPrinterDriverDirectory　　判断指定系统中包含了打印机驱动程序的目录是什么

AddPrinter　　在系统中添加一台新打印机

DeletePrinter　　将指定的打印机标志为从系统中删除

DeletePrinterDriver　　从系统删除一个打印机驱动程序

DeletePrinterDriverEx　　从系统删除一个打印机驱动程序和相关的文件

FlushPrinter　　更新打印机，清楚错误状态的打印机
`
</code></pre>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>21song </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=/1/pywin32%E6%8E%A7%E5%88%B6%E4%BD%A0%E7%9A%84%E6%89%93%E5%8D%B0%E6%9C%BA/>/1/pywin32%E6%8E%A7%E5%88%B6%E4%BD%A0%E7%9A%84%E6%89%93%E5%8D%B0%E6%9C%BA/</span>
            </p>
            
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="/tags/python/">
                    #python</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="/">home</a></span>
        </section>
    </div>

    <div class="post-nav">
         
        
        <a href="/1/bi%E6%9E%B6%E6%9E%84%E6%A6%82%E5%BF%B5/" class="next" rel="next" title="bi架构">bi架构&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2016 - 2019</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="/">21song</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
    
    <script src="/js/vendor_no_gallery.min.js" async=""></script>
    
  



     </div>
  </body>
</html>
